<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.420">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pedro J. Aphalo">
<meta name="dcterms.date" content="2023-11-19">

<title>Design of Experiments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="design-experiments_files/libs/clipboard/clipboard.min.js"></script>
<script src="design-experiments_files/libs/quarto-html/quarto.js"></script>
<script src="design-experiments_files/libs/quarto-html/popper.min.js"></script>
<script src="design-experiments_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="design-experiments_files/libs/quarto-html/anchor.min.js"></script>
<link href="design-experiments_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="design-experiments_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="design-experiments_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="design-experiments_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="design-experiments_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Design of Experiments</h1>
<p class="subtitle lead">Playing with numbers</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pedro J. Aphalo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 19, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 20, 2023</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="simulated-experiments" class="level1">
<h1>Simulated experiments</h1>
<ul>
<li><p>Generating artificial data by random sampling of a theoretical density distribution, here the Normal distribution, we can simulate different experiments to learn how outcomes of real experiments depend on how we design them.</p></li>
<li><p>We will use “Apps” that run interactively through a web browser interface, within this page.</p></li>
<li><p>Today you will learn broad patterns, and we will worry later in the course about the details.</p></li>
<li><p>The idea is for you to start developing an understanding of how to interpret results from data analysis, as well as of gauging by looking at plot very roughly what to expect.</p></li>
<li><p>In some cases parameter estimates and results from significance tests are shown. The main point today is not to understand them in detail, but do pay attention how estimates for the values of the parameters vary in succesive simulations sampled using exactly the same settings.</p></li>
</ul>
</section>
<section id="how-do-sampled-data-look-as-population-parameters-change" class="level1">
<h1>1. How do sampled data look as population parameters change?</h1>
<p>In this App, you can change settings related to the simulated data:</p>
<ul>
<li>The mean of the Control Normal distribution is constant at zero.</li>
<li>You can choose the value of the mean for Treatment.</li>
<li>You can choose the value of the standard deviation (the same value is used for Control and Treatment).</li>
<li>You can choose the size of samples (<span class="math inline">\(\approx\)</span> number of replicates).</li>
</ul>
<p>You can also change settings related to how the outcomes of the simulations are displayed:</p>
<ul>
<li><p>The type of plot:</p>
<ol type="a">
<li>“density” shows simulated observations as rug plots on the <span class="math inline">\(x\)</span> axis, fitted <em>sample</em> empirical distributions density functions and the <em>population</em> means (the settings above) as blue vertical lines.</li>
<li>“histogram” shows histograms instead of the fitted density function.</li>
</ol></li>
<li><p>The minimum limits of the x-axis, which makes it easier to compare simulations using different settings for standard deviation.</p></li>
<li><p><strong>To do:</strong> Run <strong>15</strong> or more simulations with the same settings.</p>
<ul>
<li>observe how the sample mean and sd change when you:</li>
</ul></li>
<li><p>Keep constant the standard deviation of the populations sampled.</p>
<ul>
<li>change the Treatment effect size.</li>
</ul></li>
<li><p>Keep the Treatment effect size constant.</p>
<ul>
<li>change the standard deviation of the populations sampled.</li>
</ul></li>
<li><p>Keep the Treatment effect size and the standard deviation constant.</p>
<ul>
<li>change number of replicates.</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="mean_treat-label" for="mean_treat">Mean of 'Treatment':</label>
<div>
<select id="mean_treat" class="shiny-input-select"><option value="0.001">0.001</option>
<option value="0.01">0.01</option>
<option value="0.1">0.1</option>
<option value="1">1</option>
<option value="10" selected="">10</option>
<option value="100">100</option></select>
<script type="application/json" data-for="mean_treat" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="sd_adjust-label" for="sd_adjust">Standard deviation:</label>
<input class="js-range-slider" id="sd_adjust" data-skin="shiny" data-min="0.2" data-max="10" data-from="1" data-step="0.2" data-grid="true" data-grid-num="9.8" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="n_replicates-label" for="n_replicates">Number of replicates:</label>
<div>
<select id="n_replicates" class="shiny-input-select"><option value="10">10</option>
<option value="20">20</option>
<option value="40">40</option>
<option value="100" selected="">100</option>
<option value="1000">1000</option>
<option value="10000">10000</option></select>
<script type="application/json" data-for="n_replicates" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="plot_type-label" for="plot_type">Plot type:</label>
<div>
<select id="plot_type" class="shiny-input-select"><option value="density" selected="">density</option>
<option value="histogram">histogram</option></select>
<script type="application/json" data-for="plot_type" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="expand_xlim-label" for="expand_xlim">x-axis minimum limits:</label>
<input class="js-range-slider" id="expand_xlim" data-skin="shiny" data-min="0" data-max="50" data-from="40" data-step="1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<button id="refresh" type="button" class="btn btn-default action-button">New simulation</button>
</div>
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="samplingPlot" style="width:100%;height:500px;"></div>
</div>
</div>
</section>
<section id="sample-summaries" class="level1">
<h1>2. Sample summaries</h1>
<p>Here you should pay attention to the difference between the mean of the Normal population from which the sample was drawn and the mean estimated from the sample. You should also pay attention to the difference between the standard deviation of the Normal population from which the sample was drawn and the standard deviation estimated from the sample.</p>
<ul>
<li><strong>To do:</strong> Run <strong>15</strong> or more simulations with the same settings.
<ul>
<li>observe how the sample mean and sd change when you:</li>
</ul></li>
<li>Keep constant the standard deviation of the populations sampled.
<ul>
<li>change the Treatment effect size.</li>
</ul></li>
<li>Keep the Treatment effect size constant.
<ul>
<li>change the standard deviation of the populations sampled.</li>
</ul></li>
<li>Keep the Treatment effect size and the standard deviation constant.
<ul>
<li>change number of replicates.</li>
</ul></li>
</ul>
<p>You can next select to have the <em>t</em>-test shown, and repeat the exercise above paying attention to whether the conclusion you would draw from the <em>t</em>-test vary among simulations done using the same settings.</p>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="mean_treat1-label" for="mean_treat1">Mean of 'Treatment':</label>
<div>
<select id="mean_treat1" class="shiny-input-select"><option value="0.001">0.001</option>
<option value="0.01">0.01</option>
<option value="0.1">0.1</option>
<option value="1" selected="">1</option>
<option value="10">10</option>
<option value="100">100</option></select>
<script type="application/json" data-for="mean_treat1" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="n_replicates1-label" for="n_replicates1">Number of replicates:</label>
<div>
<select id="n_replicates1" class="shiny-input-select"><option value="3">3</option>
<option value="5">5</option>
<option value="10" selected="">10</option>
<option value="20">20</option>
<option value="40">40</option>
<option value="100">100</option>
<option value="1000">1000</option>
<option value="10000">10000</option></select>
<script type="application/json" data-for="n_replicates1" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="sd_adjust1-label" for="sd_adjust1">Standard deviation:</label>
<input class="js-range-slider" id="sd_adjust1" data-skin="shiny" data-min="0.2" data-max="10" data-from="1" data-step="0.2" data-grid="true" data-grid-num="9.8" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<div class="checkbox">
<label>
<input id="disp_ttest" type="checkbox" class="shiny-input-checkbox">
<span>t-test</span>
</label>
</div>
</div>
</div>
<div class="cell-output-display">
<button id="refresh1" type="button" class="btn btn-default action-button">New simulation</button>
</div>
<div class="cell-output-display">
<pre class="shiny-text-output noplaceholder" id="summaries"></pre>
</div>
</div>
</section>
<section id="simulation-experiment-anova" class="level1">
<h1>3. Simulation experiment: ANOVA</h1>
<ul>
<li><strong>To do:</strong> For each condition run <strong>15</strong> or more simulations.
<ul>
<li>consider if a non-significant <em>p</em>-value demonstrate lack of treatment effect or not.</li>
</ul></li>
<li>Keep constant the standard deviation of the populations sampled.
<ul>
<li>change the Treatment effect size.</li>
</ul></li>
<li>Keep the Treatment effect size constant.
<ul>
<li>change number of replicates and see how this affects the <em>p</em>-value and the plotted standard error. (In this case you will need to use different plot types for different numbers of replicates.)</li>
</ul></li>
<li>Keep the Treatment effect size constant.
<ul>
<li>change the standard deviation of the populations sampled.</li>
</ul></li>
</ul>
<p><strong>In the plot the error bars show mean plus and minus one standard error.</strong></p>
<ul>
<li>What can you conclude from a significant <em>P</em>-value?</li>
<li>Can you conclude something more than “significant effect”?</li>
</ul>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="mean_treat2-label" for="mean_treat2">Mean of 'Treatment':</label>
<div>
<select id="mean_treat2" class="shiny-input-select"><option value="0.001">0.001</option>
<option value="0.01">0.01</option>
<option value="0.1">0.1</option>
<option value="1" selected="">1</option>
<option value="10">10</option>
<option value="100">100</option></select>
<script type="application/json" data-for="mean_treat2" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="n_replicates2-label" for="n_replicates2">Number of replicates:</label>
<div>
<select id="n_replicates2" class="shiny-input-select"><option value="3">3</option>
<option value="5">5</option>
<option value="10" selected="">10</option>
<option value="20">20</option>
<option value="40">40</option>
<option value="100">100</option>
<option value="1000">1000</option>
<option value="10000">10000</option></select>
<script type="application/json" data-for="n_replicates2" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="sd_adjust2-label" for="sd_adjust2">Standard deviation:</label>
<input class="js-range-slider" id="sd_adjust2" data-skin="shiny" data-min="0.2" data-max="10" data-from="1" data-step="0.2" data-grid="true" data-grid-num="9.8" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<button id="refresh2" type="button" class="btn btn-default action-button">New simulation</button>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="plot_type2-label" for="plot_type2">Plot type:</label>
<div>
<select id="plot_type2" class="shiny-input-select"><option value="dot plot">dot plot</option>
<option value="violin plot">violin plot</option>
<option value="beeswarm plot" selected="">beeswarm plot</option>
<option value="box plot">box plot</option></select>
<script type="application/json" data-for="plot_type2" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="replicationPlot" style="width:100%;height:500px;"></div>
</div>
</div>
</section>
<section id="simulation-experiment-linear-regression" class="level1">
<h1>4. Simulation experiment: linear regression</h1>
<ul>
<li><strong>To do:</strong> For each condition run <strong>15</strong> or more simulations.
<ul>
<li>observe how statistical significance and <span class="math inline">\(R^2\)</span> vary when you:</li>
</ul></li>
<li>Keep constant the standard deviation of the populations sampled.
<ul>
<li>change the slope size.</li>
<li>change the intercept size.</li>
</ul></li>
<li>Keep the slope size constant.
<ul>
<li>change the standard deviation of the populations sampled.</li>
</ul></li>
<li>Keep the Treatment effect size and the standard deviation constant.
<ul>
<li>change number of replicates.</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="num_intercept4-label" for="num_intercept4">Intercept:</label>
<div>
<select id="num_intercept4" class="shiny-input-select"><option value="-10">-10</option>
<option value="-1">-1</option>
<option value="-0.1">-0.1</option>
<option value="0" selected="">0</option>
<option value="0.1">0.1</option>
<option value="1">1</option>
<option value="10">10</option></select>
<script type="application/json" data-for="num_intercept4" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="num_slope4-label" for="num_slope4">Slope of resp. to x:</label>
<div>
<select id="num_slope4" class="shiny-input-select"><option value="-1">-1</option>
<option value="-0.1">-0.1</option>
<option value="0">0</option>
<option value="0.1" selected="">0.1</option>
<option value="1">1</option></select>
<script type="application/json" data-for="num_slope4" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="num_observations4-label" for="num_observations4">n data:</label>
<div>
<select id="num_observations4" class="shiny-input-select"><option value="5">5</option>
<option value="10">10</option>
<option value="25">25</option>
<option value="50">50</option>
<option value="100" selected="">100</option>
<option value="1000">1000</option>
<option value="10000">10000</option></select>
<script type="application/json" data-for="num_observations4" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="sd_adjust4-label" for="sd_adjust4">s.d.:</label>
<input class="js-range-slider" id="sd_adjust4" data-skin="shiny" data-min="0" data-max="10" data-from="1" data-step="0.2" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<div class="checkbox">
<label>
<input id="disp_equation4" type="checkbox" class="shiny-input-checkbox" checked="checked">
<span>Equation</span>
</label>
</div>
</div>
</div>
<div class="cell-output-display">
<button id="refresh4" type="button" class="btn btn-default action-button">New simulation</button>
</div>
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="lm2plot" style="width:100%;height:500px;"></div>
</div>
</div>
</section>
<section id="how-did-i-create-these-interactive-app" class="level1">
<h1>How did I create these interactive App?</h1>
<p>This Quarto presentation is made interactive using Shiny, an R package. The viewers of the presentation can change the values of parameters underlying what’s computed and displayed and see the results immediately.</p>
<p>To learn more, see <a href="http://rmarkdown.rstudio.com/authoring_shiny.html">Interactive Documents</a>.</p>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
knitr::opts_chunk$set(echo = FALSE, fig.width = 6, fig.height = 5)
</script>
 
<script type="application/shiny-prerendered" data-context="server-start">
library(ggplot2)
library(ggpmisc)
library(ggpp)
library(broom)
library(ggbeeswarm)
library(Hmisc)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
generate_samples <- function() {
  num_replicates <- as.numeric(input$n_replicates)
  num_mean <- as.numeric(input$mean_treat)
  y <- c(rnorm(n = num_replicates, mean = 0, sd = input$sd_adjust),
         rnorm(n = num_replicates, mean = num_mean, sd = input$sd_adjust))
  group <- factor(rep(c("Control", "Treatment"), rep(num_replicates, 2)))
  data.frame(y, group)
} 

output$samplingPlot <- renderPlot({
  ggplot(generate_samples(), aes(y, colour = group, fill = group)) +
    geom_vline(xintercept = c(0, as.numeric(input$mean_treat)), 
               linetype = "dotted", color = "blue") +
    geom_rug() +
    switch(input$plot_type,
           density = geom_density(linewidth = 1, alpha = 0.2),
           histogram = geom_histogram(aes(y = after_stat(density)),
                                      linewidth = 1, alpha = 0.2, 
                                      position = "identity")) +
    annotate(x = 1.5, y = 0, label = input$refresh, alpha = 0, geom = "text") +
#    scale_x_continuous(limits = function(x) {x + (diff(x) * 0.1) * c(-1,1)}) +
    expand_limits(x = c(-input$expand_xlim, input$expand_xlim + as.numeric(input$mean_treat))) +
    stat_group_counts(size = 6) +
    labs(x = "Draws from two Normal distributions",
         y = "Estimated density\n(Area for each group equal to one)") +
    theme_bw(20)
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$summaries <- renderPrint({
  num_replicates <- as.numeric(input$n_replicates1)
  num_mean <- as.numeric(input$mean_treat1)
  y <- c(rnorm(n = num_replicates, mean = 0, sd = input$sd_adjust1),
         rnorm(n = num_replicates, mean = num_mean, sd = input$sd_adjust1))
  group <- factor(rep(c("Control", "Treatment"), rep(num_replicates, 2)))
  df <- data.frame(y, group)
  if (input$disp_ttest) {
    t.test(y ~ group, data = df)
  } else {
    data.frame(group = c("Control", "Treatment"),
               n = num_replicates,
               pop.mean = c(0, num_mean),
               samp.mean = signif(c(mean(df[df$group == "Control", "y"]),
                                    mean(df[df$group == "Treatment", "y"])), 3),
               pop.sd = input$sd_adjust1,
               samp.sd = signif(c(sd(df[df$group == "Control", "y"]),
                                  sd(df[df$group == "Treatment", "y"])), 3),
               simulation = rep(input$refresh1[1], 2)
    )
  }
})

</script>
 
<script type="application/shiny-prerendered" data-context="server">
generate_data <- function() {
  num_replicates <- as.numeric(input$n_replicates2)
  num_mean <- as.numeric(input$mean_treat2)
  y <- c(rnorm(n = num_replicates, mean = 0, sd = input$sd_adjust2),
         rnorm(n = num_replicates, mean = num_mean, sd = input$sd_adjust2))
  x <- factor(rep(c("Control", "Treatment"), rep(num_replicates, 2)))
  data.frame(y, x)
} 

output$replicationPlot <- renderPlot({
  ggplot(generate_data(), aes(x, y)) +
    switch(input$plot_type2,
           "dot plot" = geom_point(alpha = 0.25, size = 3),
           "violin plot" = geom_violin(fill = "grey50", 
                                       linewidth = 1, 
                                       alpha = 0.2),
           "beeswarm plot" = geom_beeswarm(color = "grey50"),
           "box plot" = geom_boxplot(fill = "grey50", 
                                     linewidth = 1, 
                                     alpha = 0.2,
                                     width = 0.2)) +
    stat_summary(fun.data = "mean_se", color = "red",
                 size = 1, linewidth = 1, alpha = 0.67) +
    geom_hline(yintercept = c(0, as.numeric(input$mean_treat2)), 
               linetype = "dotted", color = "blue", linewidth = 1) +
    stat_fit_tb(tb.type = "fit.anova", size = 5,
                digits = 3,
                p.digits = 4,
                tb.params = c("Group" = 1, "Error" = 2),
                tb.vars = c("Effect" = 1, "df" = 2, SS = 3,
                            MS = 4, "italic(F)" = 5,
                            "italic(P)" = 6),
                parse = TRUE) +
    annotate(x = 1.5, y = 0, label = input$refresh2, alpha = 0, geom = "text") +
    labs(x = "Group", y = "Observed values") +
    theme_bw(20)
})

</script>
 
<script type="application/shiny-prerendered" data-context="server">
generate_data4 <- function() {
  num_observations <- as.integer(input$num_observations4)
  num_slope <- as.numeric(input$num_slope4)
  num_intercept <- as.numeric(input$num_intercept4)
  x <- seq(from = 0, to = 50, length.out = num_observations)
  y <- num_intercept + x * num_slope + 
    c(rnorm(n = num_observations, mean = 0, sd = input$sd_adjust4))
  data.frame(x, y)
} 

output$lm2plot <- renderPlot({
      p <-
        ggplot(generate_data4(), aes(x, y)) +
        geom_point(alpha = 0.25) +
        geom_abline(intercept = as.numeric(input$num_intercept4), 
                    slope = as.numeric(input$num_slope4), 
                    linetype = "dotted", color = "blue", linewidth = 1) +
        geom_rug(alpha = 0.1) +
        geom_smooth(method = "lm", formula = y ~ x, linewidth = 1) +
        scale_x_continuous(name = "Dose, x") +
        scale_y_continuous(name = "Response, y", expand = expansion(c(0.05, 0.21))) +
        annotate(x = 1.5, y = 0, label = input$refresh4, alpha = 0, geom = "text") +
        theme_bw(20)
      
      if (input$disp_equation4) {
        p + stat_poly_eq(use_label(c("eq", "R2", "F", "P", "n")), 
                         formula = y ~ x, parse = TRUE, size = 6, label.x = "center")
      } else {
        p + stat_fit_tb(label.x = "center", label.y = 1, size = 5)
      }
    })
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.0"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86]}},"value":[{"type":"character","attributes":{},"value":["backports","base","base64enc","beeswarm","broom","bslib","cachem","checkmate","cli","cluster","colorspace","compiler","data.table","datasets","digest","dplyr","ellipsis","evaluate","fansi","fastmap","foreign","Formula","generics","ggbeeswarm","ggplot2","ggpmisc","ggpp","glue","graphics","grDevices","grid","gridExtra","gtable","Hmisc","htmlTable","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","lattice","lifecycle","magrittr","MASS","Matrix","MatrixModels","memoise","methods","mime","munsell","nnet","pillar","pkgconfig","polynom","promises","purrr","quantreg","R6","Rcpp","rlang","rmarkdown","rpart","rstudioapi","sass","scales","shiny","SparseM","splines","stats","stringi","stringr","survival","tibble","tidyr","tidyselect","tools","utf8","utils","vctrs","vipor","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.4.1","4.3.2","0.1-3","0.4.0","1.0.5","0.5.1","1.0.8","2.3.0","3.6.1","2.1.4","2.1-0","4.3.2","1.14.8","4.3.2","0.6.33","1.1.4","0.3.2","0.23","1.0.5","1.1.1","0.8-85","1.2-5","0.1.3","0.7.2","3.4.4","0.5.5","0.5.5","1.6.2","4.3.2","4.3.2","4.3.2","2.3","0.3.4","5.1-1","2.4.2","0.5.7","1.6.2","1.6.12","0.1.4","1.8.7","1.45","1.3.1","0.22-5","1.0.4","2.0.3","7.3-60","1.6-3","0.5-3","2.0.1","4.3.2","0.12","0.5.0","7.3-19","1.9.0","2.0.3","1.4-1","1.2.1","1.0.2","5.97","2.5.1","1.0.11","1.1.2","2.25","4.1.21","0.15.0","0.4.7","1.2.1","1.8.0","1.81","4.3.2","4.3.2","1.8.1","1.5.1","3.5-7","3.2.1","1.3.0","1.2.0","4.3.2","1.2.4","4.3.2","0.6.4","0.4.5","2.5.2","0.41","1.8-4","2.3.7"]}]}]}
</script>
<!--/html_preserve-->
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>